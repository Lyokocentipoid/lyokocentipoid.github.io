<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tipus d'angles Â· GeoMat 1r ESO</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg:     #0d0f1a;
      --surface:#151828;
      --card:   #1c2038;
      --border: #2a2f50;
      --blue:   #3d8bff;
      --yellow: #f5c842;
      --coral:  #ff5f6d;
      --green:  #3dffa0;
      --purple: #b47fff;
      --text:   #e8eaf6;
      --muted:  #7a7fa8;
      --tr:     .2s cubic-bezier(.4,0,.2,1);

      /* angle type color â€” updated by JS */
      --angle-color: #3d8bff;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'DM Sans', sans-serif;
      font-weight: 300;
      min-height: 100vh;
      display: flex; flex-direction: column;
    }

    /* â”€â”€ NAV â”€â”€ */
    nav {
      display: flex; align-items: center; justify-content: space-between;
      padding: .9rem 2.5rem;
      background: rgba(13,15,26,.9);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      position: sticky; top: 0; z-index: 100;
    }
    .nav-logo {
      font-family: 'Syne', sans-serif; font-weight: 800;
      font-size: 1.1rem; color: var(--text); text-decoration: none;
      display: flex; align-items: center; gap: .5rem;
    }
    .nav-logo .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--blue); box-shadow: 0 0 8px var(--blue); }
    .nav-right { display: flex; align-items: center; gap: 1.5rem; }
    .nav-back {
      color: var(--muted); text-decoration: none; font-size: .85rem;
      display: flex; align-items: center; gap: .4rem;
      transition: color var(--tr);
    }
    .nav-back:hover { color: var(--green); }
    .capsula-label {
      font-size: .75rem; font-weight: 500; text-transform: uppercase;
      letter-spacing: .1em; color: var(--green);
      background: rgba(61,255,160,.1);
      border: 1px solid rgba(61,255,160,.2);
      border-radius: 100px; padding: .25rem .75rem;
    }

    /* â”€â”€ LAYOUT â”€â”€ */
    .main-layout {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: 0;
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
      padding: 2.5rem 2rem;
      gap: 2rem;
    }

    /* â”€â”€ CANVAS SIDE â”€â”€ */
    .canvas-side {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .canvas-header { }
    .canvas-header h1 {
      font-family: 'Syne', sans-serif; font-weight: 800;
      font-size: 1.8rem; letter-spacing: -.02em;
      margin-bottom: .4rem;
    }
    .canvas-header p { color: var(--muted); font-size: .9rem; line-height: 1.6; }

    .canvas-wrap {
      position: relative;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
      aspect-ratio: 4/3;
      cursor: crosshair;
      transition: border-color var(--tr);
    }
    .canvas-wrap:hover { border-color: var(--angle-color); }

    #angleCanvas {
      display: block;
      width: 100%; height: 100%;
    }

    .canvas-hint {
      position: absolute; bottom: 1rem; left: 50%; transform: translateX(-50%);
      font-size: .78rem; color: var(--muted);
      background: rgba(13,15,26,.7);
      backdrop-filter: blur(8px);
      border: 1px solid var(--border);
      border-radius: 100px;
      padding: .35rem 1rem;
      pointer-events: none;
      white-space: nowrap;
      transition: opacity .3s;
    }
    .canvas-hint.hidden { opacity: 0; }

    /* â”€â”€ ANGLE DISPLAY BADGE â”€â”€ */
    .angle-badge {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.25rem 1.75rem;
      transition: border-color var(--tr), box-shadow var(--tr);
    }
    .angle-badge.active {
      border-color: var(--angle-color);
      box-shadow: 0 0 24px rgba(0,0,0,.2), inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .angle-deg {
      font-family: 'DM Mono', monospace;
      font-size: 2.8rem;
      font-weight: 500;
      color: var(--angle-color);
      transition: color .15s;
      min-width: 100px;
      line-height: 1;
    }
    .angle-info { flex: 1; }
    .angle-name {
      font-family: 'Syne', sans-serif; font-weight: 800;
      font-size: 1.3rem;
      color: var(--angle-color);
      transition: color .15s;
      margin-bottom: .3rem;
    }
    .angle-def {
      font-size: .85rem; color: var(--muted); line-height: 1.5;
    }

    /* â”€â”€ INFO SIDE â”€â”€ */
    .info-side {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    .info-title {
      font-family: 'Syne', sans-serif; font-weight: 700;
      font-size: .8rem; letter-spacing: .1em; text-transform: uppercase;
      color: var(--muted);
      padding-bottom: .75rem;
      border-bottom: 1px solid var(--border);
    }

    /* â”€â”€ TYPE CARDS â”€â”€ */
    .type-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1rem 1.25rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      cursor: pointer;
      transition: all var(--tr);
      position: relative;
      overflow: hidden;
    }
    .type-card::before {
      content: '';
      position: absolute; left: 0; top: 0; bottom: 0;
      width: 3px;
      background: var(--t-color);
      transform: scaleY(0); transform-origin: center;
      transition: transform var(--tr);
    }
    .type-card:hover { border-color: var(--t-color); transform: translateX(4px); }
    .type-card:hover::before { transform: scaleY(1); }
    .type-card.active {
      border-color: var(--t-color);
      background: color-mix(in srgb, var(--t-color) 8%, var(--card));
    }
    .type-card.active::before { transform: scaleY(1); }

    .type-mini-canvas { width: 52px; height: 52px; flex-shrink: 0; }
    .type-info { flex: 1; }
    .type-name {
      font-family: 'Syne', sans-serif; font-weight: 700;
      font-size: .95rem; color: var(--t-color);
      margin-bottom: .2rem;
    }
    .type-range {
      font-size: .78rem; color: var(--muted);
      font-family: 'DM Mono', monospace;
    }
    .type-desc { font-size: .78rem; color: var(--muted); margin-top: .2rem; }

    /* â”€â”€ DIVIDER â”€â”€ */
    .divider {
      height: 1px; background: var(--border); margin: .25rem 0;
    }

    /* â”€â”€ NOTE BOX â”€â”€ */
    .note-box {
      background: rgba(61,139,255,.07);
      border: 1px solid rgba(61,139,255,.2);
      border-radius: 10px;
      padding: 1rem 1.25rem;
      font-size: .83rem;
      color: var(--muted);
      line-height: 1.6;
    }
    .note-box strong { color: var(--blue); }

    /* â”€â”€ FOOTER â”€â”€ */
    footer {
      border-top: 1px solid var(--border);
      padding: 1.5rem 2.5rem;
      display: flex; justify-content: space-between; align-items: center;
      color: var(--muted); font-size: .82rem;
    }

    /* â”€â”€ RESPONSIVE â”€â”€ */
    @media (max-width: 860px) {
      .main-layout { grid-template-columns: 1fr; padding: 1.5rem; }
      .info-side { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: .75rem; }
      .info-title, .divider, .note-box { grid-column: 1 / -1; }
    }
  </style>
</head>
<body>

<nav>
  <a href="../index.html" class="nav-logo"><span class="dot"></span>GeoMat 1r ESO</a>
  <div class="nav-right">
    <span class="capsula-label">Bloc 01 Â· Angles</span>
    <a href="../teoria.html" class="nav-back">â† Totes les cÃ psules</a>
  </div>
</nav>

<div class="main-layout">

  <!-- ESQUERRA: canvas -->
  <div class="canvas-side">
    <div class="canvas-header">
      <h1>Tipus d'angles</h1>
      <p>Fes clic i arrossega sobre el canvas per girar el raig. L'angle es mesura i classifica automÃ ticament.</p>
    </div>

    <div class="canvas-wrap" id="canvasWrap">
      <canvas id="angleCanvas"></canvas>
      <div class="canvas-hint" id="hint">Fes clic i arrossega per moure el raig</div>
    </div>

    <div class="angle-badge" id="angleBadge">
      <div class="angle-deg" id="degDisplay">â€”Â°</div>
      <div class="angle-info">
        <div class="angle-name" id="typeName">Arrossega el raig</div>
        <div class="angle-def" id="typeDef">Clica sobre el canvas per explorar els tipus d'angles</div>
      </div>
    </div>
  </div>

  <!-- DRETA: tipus -->
  <div class="info-side">
    <div class="info-title">Tipus d'angles</div>

    <div class="type-card" id="card-null" style="--t-color:#7a7fa8" data-min="0" data-max="0">
      <canvas class="type-mini-canvas" id="mini-null"></canvas>
      <div class="type-info">
        <div class="type-name" style="color:var(--muted)">Angle nul</div>
        <div class="type-range">= 0Â°</div>
        <div class="type-desc">Els dos raigs coincideixen.</div>
      </div>
    </div>

    <div class="type-card" id="card-agut" style="--t-color:#3dffa0" data-min="1" data-max="89">
      <canvas class="type-mini-canvas" id="mini-agut"></canvas>
      <div class="type-info">
        <div class="type-name">Angle agut</div>
        <div class="type-range">0Â° &lt; Î± &lt; 90Â°</div>
        <div class="type-desc">Menor que un angle recte.</div>
      </div>
    </div>

    <div class="type-card" id="card-recte" style="--t-color:#3d8bff" data-min="90" data-max="90">
      <canvas class="type-mini-canvas" id="mini-recte"></canvas>
      <div class="type-info">
        <div class="type-name">Angle recte</div>
        <div class="type-range">= 90Â°</div>
        <div class="type-desc">Forma exactament una cantonada.</div>
      </div>
    </div>

    <div class="type-card" id="card-obtus" style="--t-color:#f5c842" data-min="91" data-max="179">
      <canvas class="type-mini-canvas" id="mini-obtus"></canvas>
      <div class="type-info">
        <div class="type-name">Angle obtÃºs</div>
        <div class="type-range">90Â° &lt; Î± &lt; 180Â°</div>
        <div class="type-desc">Entre recte i pla.</div>
      </div>
    </div>

    <div class="type-card" id="card-pla" style="--t-color:#ff5f6d" data-min="180" data-max="180">
      <canvas class="type-mini-canvas" id="mini-pla"></canvas>
      <div class="type-info">
        <div class="type-name">Angle pla</div>
        <div class="type-range">= 180Â°</div>
        <div class="type-desc">Els dos raigs formen una recta.</div>
      </div>
    </div>

    <div class="type-card" id="card-convex" style="--t-color:#b47fff" data-min="181" data-max="359">
      <canvas class="type-mini-canvas" id="mini-convex"></canvas>
      <div class="type-info">
        <div class="type-name">Angle cÃ²ncau</div>
        <div class="type-range">180Â° &lt; Î± &lt; 360Â°</div>
        <div class="type-desc">Major que un angle pla.</div>
      </div>
    </div>

    <div class="type-card" id="card-complet" style="--t-color:#e8eaf6" data-min="360" data-max="360">
      <canvas class="type-mini-canvas" id="mini-complet"></canvas>
      <div class="type-info">
        <div class="type-name">Angle complet</div>
        <div class="type-range">= 360Â°</div>
        <div class="type-desc">Una volta sencera.</div>
      </div>
    </div>

    <div class="divider"></div>
    <div class="note-box">
      <strong>ğŸ’¡ Recorda:</strong> l'angle es mesura sempre des del raig fix (horitzontal) fins al raig mÃ²bil, en sentit contrari a les agulles del rellotge.
    </div>
  </div>

</div>

<footer>
  <span>GeoMat Â· Bloc 01 Â· Rectes i Angles</span>
  <span>Diego ValiÃ±o Â· 2026</span>
</footer>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  ANGLE TYPES CONFIG
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TYPES = [
  { id: 'null',   name: 'Angle nul',     def: 'Els dos raigs coincideixen completament.',                  color: '#7a7fa8', min: 0,   max: 0   },
  { id: 'agut',   name: 'Angle agut',    def: 'Mesura menys de 90Â°. MÃ©s tancat que una cantonada.',        color: '#3dffa0', min: 1,   max: 89  },
  { id: 'recte',  name: 'Angle recte',   def: 'Mesura exactament 90Â°. Els dos raigs sÃ³n perpendiculars.', color: '#3d8bff', min: 90,  max: 90  },
  { id: 'obtus',  name: 'Angle obtÃºs',   def: 'Mesura entre 90Â° i 180Â°. MÃ©s obert que una cantonada.',    color: '#f5c842', min: 91,  max: 179 },
  { id: 'pla',    name: 'Angle pla',     def: 'Mesura exactament 180Â°. Els raigs formen una recta.',      color: '#ff5f6d', min: 180, max: 180 },
  { id: 'convex', name: 'Angle cÃ²ncau',  def: 'Mesura entre 180Â° i 360Â°. Major que un angle pla.',        color: '#b47fff', min: 181, max: 359 },
  { id: 'complet',name: 'Angle complet', def: 'Mesura 360Â°. Una revoluciÃ³ completa.',                      color: '#e8eaf6', min: 360, max: 360 },
];

function getType(deg) {
  const d = Math.round(deg);
  return TYPES.find(t => d >= t.min && d <= t.max) || TYPES[1];
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  MAIN CANVAS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const wrap      = document.getElementById('canvasWrap');
const canvas    = document.getElementById('angleCanvas');
const ctx       = canvas.getContext('2d');
const hint      = document.getElementById('hint');
const degDisplay= document.getElementById('degDisplay');
const typeName  = document.getElementById('typeName');
const typeDef   = document.getElementById('typeDef');
const badge     = document.getElementById('angleBadge');

let W, H, cx, cy, R;
let angleDeg = 45;
let dragging = false;
let hasInteracted = false;

function resize() {
  const rect = wrap.getBoundingClientRect();
  canvas.width  = rect.width  * devicePixelRatio;
  canvas.height = rect.height * devicePixelRatio;
  canvas.style.width  = rect.width  + 'px';
  canvas.style.height = rect.height + 'px';
  W = canvas.width; H = canvas.height;
  cx = W / 2; cy = H * 0.58;
  R = Math.min(W, H) * 0.34;
  draw();
}

function draw() {
  ctx.clearRect(0, 0, W, H);
  const rad  = angleDeg * Math.PI / 180;
  const type = getType(angleDeg);
  const col  = type.color;

  // Grid (subtle)
  ctx.save();
  ctx.strokeStyle = 'rgba(255,255,255,0.03)';
  ctx.lineWidth = 1;
  const step = W / 10;
  for (let x = 0; x < W; x += step) { ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, H); ctx.stroke(); }
  for (let y = 0; y < H; y += step) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(W, y); ctx.stroke(); }
  ctx.restore();

  // Arc fill
  ctx.save();
  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.arc(cx, cy, R * 0.55, 0, -rad, true);
  ctx.closePath();
  ctx.fillStyle = col + '18';
  ctx.fill();
  ctx.restore();

  // Arc stroke
  ctx.save();
  ctx.beginPath();
  ctx.arc(cx, cy, R * 0.55, 0, -rad, true);
  ctx.strokeStyle = col + 'aa';
  ctx.lineWidth = 2 * devicePixelRatio;
  ctx.setLineDash([]);
  ctx.stroke();
  ctx.restore();

  // Fixed ray (horizontal â†’ right)
  drawRay(cx, cy, 0, R, col, 3, false);

  // Moving ray
  drawRay(cx, cy, -rad, R, col, 3, true);

  // Right-angle square if ~90Â°
  if (Math.abs(angleDeg - 90) < 1.5) {
    const s = 22 * devicePixelRatio;
    ctx.save();
    ctx.strokeStyle = col;
    ctx.lineWidth = 2 * devicePixelRatio;
    ctx.beginPath();
    ctx.moveTo(cx + s, cy);
    ctx.lineTo(cx + s, cy - s);
    ctx.lineTo(cx, cy - s);
    ctx.stroke();
    ctx.restore();
  }

  // Degree label on arc
  const labelAngle = -rad / 2;
  const lr = R * 0.55 + 28 * devicePixelRatio;
  const lx = cx + Math.cos(labelAngle) * lr;
  const ly = cy + Math.sin(labelAngle) * lr;
  ctx.save();
  ctx.font = `bold ${13 * devicePixelRatio}px 'DM Mono', monospace`;
  ctx.fillStyle = col;
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  if (angleDeg > 5 && angleDeg < 355) {
    ctx.fillText(Math.round(angleDeg) + 'Â°', lx, ly);
  }
  ctx.restore();

  // Origin dot
  ctx.beginPath();
  ctx.arc(cx, cy, 5 * devicePixelRatio, 0, Math.PI * 2);
  ctx.fillStyle = col;
  ctx.shadowColor = col;
  ctx.shadowBlur = 10;
  ctx.fill();
  ctx.shadowBlur = 0;
}

function drawRay(ox, oy, angle, len, color, lw, arrow) {
  const ex = ox + Math.cos(angle) * len;
  const ey = oy + Math.sin(angle) * len;
  ctx.save();
  ctx.beginPath();
  ctx.moveTo(ox, oy);
  ctx.lineTo(ex, ey);
  ctx.strokeStyle = color;
  ctx.lineWidth   = lw * devicePixelRatio;
  ctx.lineCap     = 'round';
  ctx.shadowColor = color;
  ctx.shadowBlur  = 6;
  ctx.stroke();
  ctx.shadowBlur  = 0;
  if (arrow) {
    const aLen = 12 * devicePixelRatio;
    const aAngle = Math.PI / 6;
    const dir = Math.atan2(ey - oy, ex - ox);
    ctx.beginPath();
    ctx.moveTo(ex, ey);
    ctx.lineTo(ex - aLen * Math.cos(dir - aAngle), ey - aLen * Math.sin(dir - aAngle));
    ctx.moveTo(ex, ey);
    ctx.lineTo(ex - aLen * Math.cos(dir + aAngle), ey - aLen * Math.sin(dir + aAngle));
    ctx.stroke();
  }
  ctx.restore();
}

function updateUI(deg) {
  const type = getType(deg);
  const rounded = Math.round(deg);
  degDisplay.textContent = rounded + 'Â°';
  typeName.textContent   = type.name;
  typeDef.textContent    = type.def;

  // Update CSS color token
  document.documentElement.style.setProperty('--angle-color', type.color);
  badge.classList.add('active');

  // Highlight matching card
  document.querySelectorAll('.type-card').forEach(c => c.classList.remove('active'));
  const activeCard = document.getElementById('card-' + type.id);
  if (activeCard) activeCard.classList.add('active');
}

function angleFromPointer(e) {
  const rect = canvas.getBoundingClientRect();
  const dpr  = devicePixelRatio;
  let clientX, clientY;
  if (e.touches) {
    clientX = e.touches[0].clientX;
    clientY = e.touches[0].clientY;
  } else {
    clientX = e.clientX;
    clientY = e.clientY;
  }
  const x = (clientX - rect.left) * dpr - cx;
  const y = (clientY - rect.top)  * dpr - cy;
  let deg = -Math.atan2(y, x) * 180 / Math.PI;
  if (deg < 0) deg += 360;
  return deg;
}

function onStart(e) {
  e.preventDefault();
  dragging = true;
  if (!hasInteracted) {
    hasInteracted = true;
    hint.classList.add('hidden');
  }
  angleDeg = angleFromPointer(e);
  updateUI(angleDeg);
  draw();
}

function onMove(e) {
  if (!dragging) return;
  e.preventDefault();
  angleDeg = angleFromPointer(e);
  updateUI(angleDeg);
  draw();
}

function onEnd() { dragging = false; }

canvas.addEventListener('mousedown',  onStart);
canvas.addEventListener('mousemove',  onMove);
canvas.addEventListener('mouseup',    onEnd);
canvas.addEventListener('mouseleave', onEnd);
canvas.addEventListener('touchstart', onStart, { passive: false });
canvas.addEventListener('touchmove',  onMove,  { passive: false });
canvas.addEventListener('touchend',   onEnd);

// Click on type card â†’ jump to representative angle
document.querySelectorAll('.type-card').forEach(card => {
  card.addEventListener('click', () => {
    const min = +card.dataset.min;
    const max = +card.dataset.max;
    const target = min === max ? min : Math.round((min + max) / 2);
    animateTo(target);
    if (!hasInteracted) { hasInteracted = true; hint.classList.add('hidden'); }
  });
});

function animateTo(target) {
  const start = angleDeg;
  const diff  = target - start;
  const dur   = 400;
  const t0    = performance.now();
  function step(now) {
    const p = Math.min((now - t0) / dur, 1);
    const ease = 1 - Math.pow(1 - p, 3);
    angleDeg = start + diff * ease;
    updateUI(angleDeg);
    draw();
    if (p < 1) requestAnimationFrame(step);
    else { angleDeg = target; updateUI(target); draw(); }
  }
  requestAnimationFrame(step);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  MINI CANVASES (type cards)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const miniAngles = { null: 0, agut: 45, recte: 90, obtus: 135, pla: 180, convex: 270, complet: 359.5 };

function drawMini(id, color, deg) {
  const c  = document.getElementById('mini-' + id);
  const dpr = devicePixelRatio;
  c.width  = 52 * dpr; c.height = 52 * dpr;
  c.style.width = '52px'; c.style.height = '52px';
  const x  = c.getContext('2d');
  const cx2 = 28 * dpr, cy2 = 34 * dpr, r = 16 * dpr, len = 20 * dpr;
  const rad = deg * Math.PI / 180;

  // Arc
  x.beginPath();
  x.moveTo(cx2, cy2);
  x.arc(cx2, cy2, r, 0, -rad, true);
  x.closePath();
  x.fillStyle = color + '22';
  x.fill();
  x.beginPath();
  x.arc(cx2, cy2, r, 0, -rad, true);
  x.strokeStyle = color + '99';
  x.lineWidth = 1.5 * dpr;
  x.stroke();

  // Fixed ray
  x.beginPath(); x.moveTo(cx2, cy2); x.lineTo(cx2 + len, cy2);
  x.strokeStyle = color; x.lineWidth = 1.5 * dpr; x.lineCap = 'round'; x.stroke();

  // Moving ray
  if (deg !== 360) {
    x.beginPath(); x.moveTo(cx2, cy2);
    x.lineTo(cx2 + Math.cos(-rad) * len, cy2 + Math.sin(-rad) * len);
    x.stroke();
  } else {
    x.beginPath(); x.moveTo(cx2, cy2); x.lineTo(cx2 + len, cy2 - 0.5); x.stroke();
  }

  // Right-angle square
  if (deg === 90) {
    const s = 6 * dpr;
    x.beginPath();
    x.moveTo(cx2 + s, cy2); x.lineTo(cx2 + s, cy2 - s); x.lineTo(cx2, cy2 - s);
    x.strokeStyle = color; x.lineWidth = 1.2 * dpr; x.stroke();
  }

  // Origin dot
  x.beginPath(); x.arc(cx2, cy2, 2.5 * dpr, 0, Math.PI * 2);
  x.fillStyle = color; x.fill();
}

TYPES.forEach(t => drawMini(t.id, t.color, miniAngles[t.id]));

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  INIT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.addEventListener('resize', resize);
resize();
// Start with 45Â° shown
angleDeg = 45;
updateUI(45);
draw();
</script>
</body>
</html>
